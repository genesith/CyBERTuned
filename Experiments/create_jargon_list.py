# Sample code to test our tokenizer's vocabulary.
import json
from transformers import AutoTokenizer
# Load tokenizers
roberta = AutoTokenizer.from_pretrained('roberta-base')

# 191 Attack Techniques listed in https://attack.mitre.org/techniques/enterprise/
Attack_Techniques = ['Abuse Elevation Control Mechanism', 'Access Token Manipulation', 'Account Access Removal', 'Account Discovery', 'Account Manipulation', 'Acquire Infrastructure', 'Active Scanning', 'Adversary-in-the-Middle', 'Application Layer Protocol', 'Application Window Discovery', 'Archive Collected Data', 'Audio Capture', 'Automated Collection', 'Automated Exfiltration', 'BITS Jobs', 'Boot or Logon Autostart Execution', 'Boot or Logon Initialization Scripts', 'Browser Bookmark Discovery', 'Browser Extensions', 'Browser Session Hijacking', 'Brute Force', 'Build Image on Host', 'Clipboard Data', 'Cloud Infrastructure Discovery', 'Cloud Service Dashboard', 'Cloud Service Discovery', 'Cloud Storage Object Discovery', 'Command and Scripting Interpreter', 'Communication Through Removable Media', 'Compromise Accounts', 'Compromise Client Software Binary', 'Compromise Infrastructure', 'Container Administration Command', 'Container and Resource Discovery', 'Create Account', 'Create or Modify System Process', 'Credentials from Password Stores', 'Data Destruction', 'Data Encoding', 'Data Encrypted for Impact', 'Data from Cloud Storage Object', 'Data from Configuration Repository', 'Data from Information Repositories', 'Data from Local System', 'Data from Network Shared Drive', 'Data from Removable Media', 'Data Manipulation', 'Data Obfuscation', 'Data Staged', 'Data Transfer Size Limits', 'Debugger Evasion', 'Defacement', 'Deobfuscate/Decode Files or Information', 'Deploy Container', 'Develop Capabilities', 'Direct Volume Access', 'Disk Wipe', 'Domain Policy Modification', 'Domain Trust Discovery', 'Drive-by Compromise', 'Dynamic Resolution', 'Email Collection', 'Encrypted Channel', 'Endpoint Denial of Service', 'Escape to Host', 'Establish Accounts', 'Event Triggered Execution', 'Execution Guardrails', 'Exfiltration Over Alternative Protocol', 'Exfiltration Over C2 Channel', 'Exfiltration Over Other Network Medium', 'Exfiltration Over Physical Medium', 'Exfiltration Over Web Service', 'Exploit Public-Facing Application', 'Exploitation for Client Execution', 'Exploitation for Credential Access', 'Exploitation for Defense Evasion', 'Exploitation for Privilege Escalation', 'Exploitation of Remote Services', 'External Remote Services', 'Fallback Channels', 'File and Directory Discovery', 'File and Directory Permissions Modification', 'Firmware Corruption', 'Forced Authentication', 'Forge Web Credentials', 'Gather Victim Host Information', 'Gather Victim Identity Information', 'Gather Victim Network Information', 'Gather Victim Org Information', 'Group Policy Discovery', 'Hardware Additions', 'Hide Artifacts', 'Hijack Execution Flow', 'Impair Defenses', 'Implant Internal Image', 'Indicator Removal on Host', 'Indirect Command Execution', 'Ingress Tool Transfer', 'Inhibit System Recovery', 'Input Capture', 'Inter-Process Communication', 'Internal Spearphishing', 'Lateral Tool Transfer', 'Masquerading', 'Modify Authentication Process', 'Modify Cloud Compute Infrastructure', 'Modify Registry', 'Modify System Image', 'Multi-Factor Authentication Interception', 'Multi-Factor Authentication Request Generation', 'Multi-Stage Channels', 'Native API', 'Network Boundary Bridging', 'Network Denial of Service', 'Network Service Discovery', 'Network Share Discovery', 'Network Sniffing', 'Non-Application Layer Protocol', 'Non-Standard Port', 'Obfuscated Files or Information', 'Obtain Capabilities', 'Office Application Startup', 'OS Credential Dumping', 'Password Policy Discovery', 'Peripheral Device Discovery', 'Permission Groups Discovery', 'Phishing', 'Phishing for Information', 'Plist File Modification', 'Pre-OS Boot', 'Process Discovery', 'Process Injection', 'Protocol Tunneling', 'Proxy', 'Query Registry', 'Reflective Code Loading', 'Remote Access Software', 'Remote Service Session Hijacking', 'Remote Services', 'Remote System Discovery', 'Replication Through Removable Media', 'Resource Hijacking', 'Rogue Domain Controller', 'Rootkit', 'Scheduled Task/Job', 'Scheduled Transfer', 'Screen Capture', 'Search Closed Sources', 'Search Open Technical Databases', 'Search Open Websites/Domains', 'Search Victim-Owned Websites', 'Server Software Component', 'Service Stop', 'Shared Modules', 'Software Deployment Tools', 'Software Discovery', 'Stage Capabilities', 'Steal Application Access Token', 'Steal or Forge Kerberos Tickets', 'Steal Web Session Cookie', 'Subvert Trust Controls', 'Supply Chain Compromise', 'System Binary Proxy Execution', 'System Information Discovery', 'System Location Discovery', 'System Network Configuration Discovery', 'System Network Connections Discovery', 'System Owner/User Discovery', 'System Script Proxy Execution', 'System Service Discovery', 'System Services', 'System Shutdown/Reboot', 'System Time Discovery', 'Taint Shared Content', 'Template Injection', 'Traffic Signaling', 'Transfer Data to Cloud Account', 'Trusted Developer Utilities Proxy Execution', 'Trusted Relationship', 'Unsecured Credentials', 'Unused/Unsupported Cloud Regions', 'Use Alternate Authentication Material', 'User Execution', 'Valid Accounts', 'Video Capture', 'Virtualization/Sandbox Evasion', 'Weaken Encryption', 'Web Service', 'Windows Management Instrumentation', 'XSL Script Processing']
Attack_Techniques_and_Subs = ['Abuse Elevation Control Mechanism', 'Setuid and Setgid', 'Bypass User Account Control', 'Sudo and Sudo Caching', 'Elevated Execution with Prompt', 'Access Token Manipulation', 'Token Impersonation/Theft', 'Create Process with Token', 'Make and Impersonate Token', 'Parent PID Spoofing', 'SID-History Injection', 'Account Access Removal', 'Account Discovery', 
    'Local Account', 'Domain Account', 'Email Account', 'Cloud Account', 'Account Manipulation', 'Additional Cloud Credentials', 'Additional Email Delegate Permissions', 'Additional Cloud Roles', 'SSH Authorized Keys', 'Device Registration', 'Acquire Infrastructure', 'Domains', 'DNS Server', 'Virtual Private Server', 'Server', 'Botnet', 'Web Services', 'Active Scanning', 'Scanning IP Blocks',
     'Vulnerability Scanning', 'Wordlist Scanning', 'Adversary-in-the-Middle', 'LLMNR/NBT-NS Poisoning and SMB Relay', 'ARP Cache Poisoning', 'DHCP Spoofing', 'Application Layer Protocol', 'Web Protocols', 'File Transfer Protocols', 'Mail Protocols', 'DNS', 'Application Window Discovery', 'Archive Collected Data', 'Archive via Utility', 'Archive via Library', 'Archive via Custom Method', 
     'Audio Capture', 'Automated Collection', 'Automated Exfiltration', 'Traffic Duplication', 'BITS Jobs', 'Boot or Logon Autostart Execution', 'Registry Run Keys / Startup Folder', 'Authentication Package', 'Time Providers', 'Winlogon Helper DLL', 'Security Support Provider', 'Kernel Modules and Extensions', 'Re-opened Applications', 'LSASS Driver', 'Shortcut Modification', 'Port Monitors',
      'Print Processors', 'XDG Autostart Entries', 'Active Setup', 'Login Items', 'Boot or Logon Initialization Scripts', 'Logon Script (Windows)', 'Login Hook', 'Network Logon Script', 'RC Scripts', 'Startup Items', 'Browser Bookmark Discovery', 'Browser Extensions', 'Browser Session Hijacking', 'Brute Force', 'Password Guessing', 'Password Cracking', 'Password Spraying', 'Credential Stuffing',
       'Build Image on Host', 'Clipboard Data', 'Cloud Infrastructure Discovery', 'Cloud Service Dashboard', 'Cloud Service Discovery', 'Cloud Storage Object Discovery', 'Command and Scripting Interpreter', 'PowerShell', 'AppleScript', 'Windows Command Shell', 'Unix Shell', 'Visual Basic', 'Python', 'JavaScript', 'Network Device CLI', 'Communication Through Removable Media', 'Compromise Accounts',
        'Social Media Accounts', 'Email Accounts', 'Compromise Client Software Binary', 'Compromise Infrastructure', 'Domains', 'DNS Server', 'Virtual Private Server', 'Server', 'Botnet', 'Web Services', 'Container Administration Command', 'Container and Resource Discovery', 'Create Account', 'Local Account', 'Domain Account', 'Cloud Account', 'Create or Modify System Process', 'Launch Agent', 
        'Systemd Service', 'Windows Service', 'Launch Daemon', 'Credentials from Password Stores', 'Keychain', 'Securityd Memory', 'Credentials from Web Browsers', 'Windows Credential Manager', 'Password Managers', 'Data Destruction', 'Data Encoding', 'Standard Encoding', 'Non-Standard Encoding', 'Data Encrypted for Impact', 'Data from Cloud Storage Object', 'Data from Configuration Repository',
         'SNMP (MIB Dump)', 'Network Device Configuration Dump', 'Data from Information Repositories', 'Confluence', 'Sharepoint', 'Code Repositories', 'Data from Local System', 'Data from Network Shared Drive', 'Data from Removable Media', 'Data Manipulation', 'Stored Data Manipulation', 'Transmitted Data Manipulation', 'Runtime Data Manipulation', 'Data Obfuscation', 'Junk Data', 'Steganography',
          'Protocol Impersonation', 'Data Staged', 'Local Data Staging', 'Remote Data Staging', 'Data Transfer Size Limits', 'Debugger Evasion', 'Defacement', 'Internal Defacement', 'External Defacement', 'Deobfuscate/Decode Files or Information', 'Deploy Container', 'Develop Capabilities', 'Malware', 'Code Signing Certificates', 'Digital Certificates', 'Exploits', 'Direct Volume Access', 'Disk Wipe',
           'Disk Content Wipe', 'Disk Structure Wipe', 'Domain Policy Modification', 'Group Policy Modification', 'Domain Trust Modification', 'Domain Trust Discovery', 'Drive-by Compromise', 'Dynamic Resolution', 'Fast Flux DNS', 'Domain Generation Algorithms', 'DNS Calculation', 'Email Collection', 'Local Email Collection', 'Remote Email Collection', 'Email Forwarding Rule', 'Encrypted Channel', 
           'Symmetric Cryptography', 'Asymmetric Cryptography', 'Endpoint Denial of Service', 'OS Exhaustion Flood', 'Service Exhaustion Flood', 'Application Exhaustion Flood', 'Application or System Exploitation', 'Escape to Host', 'Establish Accounts', 'Social Media Accounts', 'Email Accounts', 'Event Triggered Execution', 'Change Default File Association', 'Screensaver', 'Windows Management Instrumentation Event Subscription',
            'Unix Shell Configuration Modification', 'Trap', 'LC_LOAD_DYLIB Addition', 'Netsh Helper DLL', 'Accessibility Features', 'AppCert DLLs', 'AppInit DLLs', 'Application Shimming', 'Image File Execution Options Injection', 'PowerShell Profile', 'Emond', 'Component Object Model Hijacking', 'Execution Guardrails', 'Environmental Keying', 'Exfiltration Over Alternative Protocol', 
            'Exfiltration Over Symmetric Encrypted Non-C2 Protocol', 'Exfiltration Over Asymmetric Encrypted Non-C2 Protocol', 'Exfiltration Over Unencrypted Non-C2 Protocol', 'Exfiltration Over C2 Channel', 'Exfiltration Over Other Network Medium', 'Exfiltration Over Bluetooth', 'Exfiltration Over Physical Medium', 'Exfiltration over USB', 'Exfiltration Over Web Service', 
            'Exfiltration to Code Repository', 'Exfiltration to Cloud Storage', 'Exploit Public-Facing Application', 'Exploitation for Client Execution', 'Exploitation for Credential Access', 'Exploitation for Defense Evasion', 'Exploitation for Privilege Escalation', 'Exploitation of Remote Services', 'External Remote Services', 'Fallback Channels', 'File and Directory Discovery', 
            'File and Directory Permissions Modification', 'Windows File and Directory Permissions Modification', 'Linux and Mac File and Directory Permissions Modification', 'Firmware Corruption', 'Forced Authentication', 'Forge Web Credentials', 'Web Cookies', 'SAML Tokens', 'Gather Victim Host Information', 'Hardware', 'Software', 'Firmware', 'Client Configurations', 'Gather Victim Identity Information', 
            'Credentials', 'Email Addresses', 'Employee Names', 'Gather Victim Network Information', 'Domain Properties', 'DNS', 'Network Trust Dependencies', 'Network Topology', 'IP Addresses', 'Network Security Appliances', 'Gather Victim Org Information', 'Determine Physical Locations', 'Business Relationships', 'Identify Business Tempo', 'Identify Roles', 'Group Policy Discovery', 'Hardware Additions', 'Hide Artifacts', 'Hidden Files and Directories', 'Hidden Users', 'Hidden Window', 'NTFS File Attributes', 'Hidden File System', 'Run Virtual Instance', 'VBA Stomping', 'Email Hiding Rules', 'Resource Forking', 'Process Argument Spoofing', 'Hijack Execution Flow', 'DLL Search Order Hijacking', 'DLL Side-Loading', 'Dylib Hijacking', 'Executable Installer File Permissions Weakness', 'Dynamic Linker Hijacking', 'Path Interception by PATH Environment Variable', 'Path Interception by Search Order Hijacking', 'Path Interception by Unquoted Path', 'Services File Permissions Weakness', 'Services Registry Permissions Weakness', 'COR_PROFILER', 'KernelCallbackTable', 'Impair Defenses', 'Disable or Modify Tools', 'Disable Windows Event Logging', 'Impair Command History Logging', 'Disable or Modify System Firewall', 'Indicator Blocking', 'Disable or Modify Cloud Firewall', 'Disable Cloud Logs', 'Safe Mode Boot', 'Downgrade Attack', 'Implant Internal Image', 'Indicator Removal on Host', 'Clear Windows Event Logs', 'Clear Linux or Mac System Logs', 'Clear Command History', 'File Deletion', 'Network Share Connection Removal', 'Timestomp', 'Indirect Command Execution', 'Ingress Tool Transfer', 'Inhibit System Recovery', 'Input Capture', 'Keylogging', 'GUI Input Capture', 'Web Portal Capture', 'Credential API Hooking', 'Inter-Process Communication', 'Component Object Model', 'Dynamic Data Exchange', 'XPC Services', 'Internal Spearphishing', 'Lateral Tool Transfer', 'Masquerading', 'Invalid Code Signature', 'Right-to-Left Override', 'Rename System Utilities', 'Masquerade Task or Service', 'Match Legitimate Name or Location', 'Space after Filename', 'Double File Extension', 'Modify Authentication Process', 'Domain Controller Authentication', 'Password Filter DLL', 'Pluggable Authentication Modules', 'Network Device Authentication', 'Reversible Encryption', 'Modify Cloud Compute Infrastructure', 'Create Snapshot', 'Create Cloud Instance', 'Delete Cloud Instance', 'Revert Cloud Instance', 'Modify Registry', 'Modify System Image', 'Patch System Image', 'Downgrade System Image', 'Multi-Factor Authentication Interception', 'Multi-Factor Authentication Request Generation', 'Multi-Stage Channels', 'Native API', 'Network Boundary Bridging', 'Network Address Translation Traversal', 'Network Denial of Service', 'Direct Network Flood', 'Reflection Amplification', 'Network Service Discovery', 'Network Share Discovery', 'Network Sniffing', 'Non-Application Layer Protocol', 'Non-Standard Port', 'Obfuscated Files or Information', 'Binary Padding', 'Software Packing', 'Steganography', 'Compile After Delivery', 'Indicator Removal from Tools', 'HTML Smuggling', 'Obtain Capabilities', 'Malware', 'Tool', 'Code Signing Certificates', 'Digital Certificates', 'Exploits', 'Vulnerabilities', 'Office Application Startup', 'Office Template Macros', 'Office Test', 'Outlook Forms', 'Outlook Home Page', 'Outlook Rules', 'Add-ins', 'OS Credential Dumping', 'LSASS Memory', 'Security Account Manager', 'NTDS', 'LSA Secrets', 'Cached Domain Credentials', 'DCSync', 'Proc Filesystem', '/etc/passwd and /etc/shadow', 'Password Policy Discovery', 'Peripheral Device Discovery', 'Permission Groups Discovery', 'Local Groups', 'Domain Groups', 'Cloud Groups', 'Phishing', 'Spearphishing Attachment', 'Spearphishing Link', 'Spearphishing via Service', 'Phishing for Information', 'Spearphishing Service', 'Spearphishing Attachment', 'Spearphishing Link', 'Plist File Modification', 'Pre-OS Boot', 'System Firmware', 'Component Firmware', 'Bootkit', 'ROMMONkit', 'TFTP Boot', 'Process Discovery', 'Process Injection', 'Dynamic-link Library Injection', 'Portable Executable Injection', 'Thread Execution Hijacking', 'Asynchronous Procedure Call', 'Thread Local Storage', 'Ptrace System Calls', 'Proc Memory', 'Extra Window Memory Injection', 'Process Hollowing', 'Process Doppelgänging', 'VDSO Hijacking', 'ListPlanting', 'Protocol Tunneling', 'Proxy', 'Internal Proxy', 'External Proxy', 'Multi-hop Proxy', 'Domain Fronting', 'Query Registry', 'Reflective Code Loading', 'Remote Access Software', 'Remote Service Session Hijacking', 'SSH Hijacking', 'RDP Hijacking', 'Remote Services', 'Remote Desktop Protocol', 'SMB/Windows Admin Shares', 'Distributed Component Object Model', 'SSH', 'VNC', 'Windows Remote Management', 'Remote System Discovery', 'Replication Through Removable Media', 'Resource Hijacking', 'Rogue Domain Controller', 'Rootkit', 'Scheduled Task/Job', 'At', 'Cron', 'Scheduled Task', 'Systemd Timers', 'Container Orchestration Job', 'Scheduled Transfer', 'Screen Capture', 'Search Closed Sources', 'Threat Intel Vendors', 'Purchase Technical Data', 'Search Open Technical Databases', 'DNS/Passive DNS', 'WHOIS', 'Digital Certificates', 'CDNs', 'Scan Databases', 'Search Open Websites/Domains', 'Social Media', 'Search Engines', 'Search Victim-Owned Websites', 'Server Software Component', 'SQL Stored Procedures', 'Transport Agent', 'Web Shell', 'IIS Components', 'Terminal Services DLL', 'Service Stop', 'Shared Modules', 'Software Deployment Tools', 'Software Discovery', 'Security Software Discovery', 'Stage Capabilities', 'Upload Malware', 'Upload Tool', 'Install Digital Certificate', 'Drive-by Target', 'Link Target', 'Steal Application Access Token', 'Steal or Forge Kerberos Tickets', 'Golden Ticket', 'Silver Ticket', 'Kerberoasting', 'AS-REP Roasting', 'Steal Web Session Cookie', 'Subvert Trust Controls', 'Gatekeeper Bypass', 'Code Signing', 'SIP and Trust Provider Hijacking', 'Install Root Certificate', 'Mark-of-the-Web Bypass', 'Code Signing Policy Modification', 'Supply Chain Compromise', 'Compromise Software Dependencies and Development Tools', 'Compromise Software Supply Chain', 'Compromise Hardware Supply Chain', 'System Binary Proxy Execution', 'Compiled HTML File', 'Control Panel', 'CMSTP', 'InstallUtil', 'Mshta', 'Msiexec', 'Odbcconf', 'Regsvcs/Regasm', 'Regsvr32', 'Rundll32', 'Verclsid', 'Mavinject', 'MMC', 'System Information Discovery', 'System Location Discovery', 'System Language Discovery', 'System Network Configuration Discovery', 'Internet Connection Discovery', 'System Network Connections Discovery', 'System Owner/User Discovery', 'System Script Proxy Execution', 'PubPrn', 'System Service Discovery', 'System Services', 'Launchctl', 'Service Execution', 'System Shutdown/Reboot', 'System Time Discovery', 'Taint Shared Content', 'Template Injection', 'Traffic Signaling', 'Port Knocking', 'Transfer Data to Cloud Account', 'Trusted Developer Utilities Proxy Execution', 'MSBuild', 'Trusted Relationship', 'Unsecured Credentials', 'Credentials In Files', 'Credentials in Registry', 'Bash History', 'Private Keys', 'Cloud Instance Metadata API', 'Group Policy Preferences', 'Container API', 'Unused/Unsupported Cloud Regions', 'Use Alternate Authentication Material', 'Application Access Token', 'Pass the Hash', 'Pass the Ticket', 'Web Session Cookie', 'User Execution', 'Malicious Link', 'Malicious File', 'Malicious Image', 'Valid Accounts', 'Default Accounts', 'Domain Accounts', 'Local Accounts', 'Cloud Accounts', 'Video Capture', 'Virtualization/Sandbox Evasion', 'System Checks', 'User Activity Based Checks', 'Time Based Evasion', 'Weaken Encryption', 'Reduce Key Space', 'Disable Crypto Hardware', 'Web Service', 'Dead Drop Resolver', 'Bidirectional Communication', 'One-Way Communication', 'Windows Management Instrumentation', 'XSL Script Processing']
Attack_Words = set()

special_chars = ["/", "-", "_", "(", ")"]

for technique in Attack_Techniques_and_Subs:
    for sc in special_chars:
        technique = technique.replace(sc, " ")
    for word in technique.split(" "):
        Attack_Words.add(word)

if "" in Attack_Words:
    Attack_Words.remove("")
if " " in Attack_Words:
    Attack_Words.remove(" ")

jargon_tokens= set()
for k in Attack_Words:
    #for variant in [" "+ k, " "+ k.lower(),k,k.lower()]:
    for variant in [" "+ k, " "+ k.lower()]:
        A= roberta(variant, add_special_tokens=False)
        if len(A.input_ids)==1:
            jargon_tokens.add(A.input_ids[0])
    
jdata = {}
for jargon in jargon_tokens:
    jdata[jargon] = roberta.decode(jargon)
with open("jargon_tokens_spaced.json",'w') as f:
    json.dump(jdata,f,indent=2)